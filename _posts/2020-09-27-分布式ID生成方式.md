---
layout:     post
title:      "分布式ID生成方式"
subtitle:   ""
date:       2020-09-27 15:47:00
author:     "胡荣"
header-img: "mysql-green-background"
tags:
  - MySQL
  - 分布式
---

## 什么是分布式ID?

## 分布式ID需要满足什么条件?
- 唯一性：必须保证ID是全局性唯一的，基本要求
- 高性能：高可用低延时，ID生成响应要块，否则反倒会成为业务瓶颈
- 高可用：100%的可用性是骗人的，但是也要无限接近于100%的可用性
- 有序性：最好趋势递增，这个要求就得看具体业务场景了，一般不严格要求
- 易拓展：要秉着拿来即用的设计原则，在系统设计和实现上要尽可能的简单

## 有哪些分布式ID的生成方式?
- UUID
- 数据库自增ID
- 数据库多主模式
- 号段模式
- Redis
- 雪花算法（SnowFlake）
- 滴滴出品（TinyID）
- 百度 （Uidgenerator）
- 美团（Leaf）

### UUID
UUID, 自不必多说, 简单好用, 全球任何机器执行下都唯一

执行后, 生成一条类似订单号的字符串 `c2b8c2b9e46c47e3b30dca3b0d447718`

缺点是:
- 字符过长, 占用大量存储空间
- 字符串是无序的, 对于查询, 排序的性能影响很大 

### 数据库自增ID

数据库的 `auto_increment` 自增ID完全可以充当分布式ID

需要一个单独的MySQL实例用来生成ID, 在业务量不是很大时使用比较方便

但不推荐在业务量大的情况下使用这种方式, 单机数据库无法承受足够大的压力

### 数据库多主模式

既然一台无法达成效果, 那么就多加一台。

但是会存在一个问题： `生成重复的ID怎么办？`

解决问题也有, 给每一个MySQL实例设置不同的步长, 区分开来, 就可以了

但随着业务增长, 机器也可能会逐步累加, 每增加一次, 就要连带着以往的Mysql实例配置的ID步长都修改

不方便扩容

### 号段模式



[1]: https://zhuanlan.zhihu.com/p/107939861
[2]: https://cloud.tencent.com/developer/article/1545881
[3]: https://www.jianshu.com/p/cbdf39577cdd
[4]: https://zhuanlan.zhihu.com/p/107939861
[5]: https://zhuanlan.zhihu.com/p/188492371
[6]: https://zhuanlan.zhihu.com/p/111255473